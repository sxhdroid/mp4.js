!function(e){var t={};function s(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,s),i.l=!0,i.exports}s.m=e,s.c=t,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)s.d(r,i,function(t){return e[t]}.bind(null,i));return r},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=17)}([function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BOX_TYPE_FILE_TYPE_BOX="ftyp",t.BOX_TYPE_MOVIE_BOX="moov",t.BOX_TYPE_MEDIA_DATA_BOX="mdat",t.BOX_TYPE_MOVIE_HEADER_BOX="mvhd",t.BOX_TYPE_TRACK_BOX="trak",t.BOX_TYPE_TRACK_HEADER_BOX="tkhd",t.BOX_TYPE_TRACK_REFERENCE_BOX="tref",t.BOX_TYPE_HINT_TRACK_REFERENCE_TYPE_BOX="hint",t.BOX_TYPE_DISCRIBE_TRACK_REFERENCE_TYPE_BOX="cdsc",t.BOX_TYPE_MEDIA_BOX="mdia",t.BOX_TYPE_MEDIA_HEADER_BOX="mdhd",t.BOX_TYPE_HANDLER_BOX="hdlr",t.BOX_TYPE_MEDIA_INFORMATION_BOX="minf",t.BOX_TYPE_VIDEO_MEDIA_HEADER_BOX="vmhd",t.BOX_TYPE_SOUND_MEDIA_HEADER_BOX="smhd",t.BOX_TYPE_HINT_MEDIA_HEADER_BOX="hmhd",t.BOX_TYPE_NULL_MEDIA_HEADER_BOX="nmhd",t.BOX_TYPE_DATA_INFORMATION_BOX="dinf",t.BOX_TYPE_DATA_REFERENCE_BOX="dref",t.BOX_TYPE_DATA_ENTRY_URL_BOX="url ",t.BOX_TYPE_DATA_ENTRY_URN_BOX="urn ",t.BOX_TYPE_SAMPLE_TABLE_BOX="stbl",t.BOX_TYPE_TIME_TO_SAMPLE_BOX="stts",t.BOX_TYPE_COMPOSITION_OFFSET_BOX="ctts",t.BOX_TYPE_ES_DESCRIPTOR_BOX="esds",t.BOX_TYPE_MP4_VISUAL_SAMPLE_ENTRY="mp4v",t.BOX_TYPE_MP4_AUDIO_SAMPLE_ENTRY="mp4a",t.BOX_TYPE_MPEG_SAMPLE_ENTRY="mp4s",t.BOX_TYPE_SAMPLE_DESCRIPTION_BOX="stsd",t.BOX_TYPE_SAMPLE_SIZE_BOX="stsz",t.BOX_TYPE_SAMPLE_TO_CHUNK_BOX="stsc",t.BOX_TYPE_CHUNK_OFFSET_BOX="stco",t.BOX_TYPE_CHUNK_OFFSET64_BOX="co64",t.BOX_TYPE_SYNC_SAMPLE_BOX="stss",t.BOX_TYPE_SHADOW_SYNC_SAMPLE_BOX="stsh",t.BOX_TYPE_DEGRADATION_PRIORITY_BOX="stdp",t.BOX_TYPE_PADDING_BITS_BOX="padb",t.BOX_TYPE_FREE_SPACE_BOX="free",t.BOX_TYPE_SKIP_BOX="skip",t.BOX_TYPE_EDIT_BOX="edts",t.BOX_TYPE_EDIT_LIST_BOX="elst",t.BOX_TYPE_COPYRIGHT_BOX="cprt",t.BOX_TYPE_MOVIE_EXTENDS_BOX="mvex",t.BOX_TYPE_MOVIE_EXTENDS_HEADER_BOX="mehd",t.BOX_TYPE_TRACK_EXTENDS_BOX="trex",t.BOX_TYPE_MOVIE_FLAGMENT_BOX="moof",t.BOX_TYPE_MOVIE_FRAGMENT_HEADER_BOX="mfhd",t.BOX_TYPE_TRACK_FRAGMENT_BOX="traf",t.BOX_TYPE_TRACK_FRAGMENT_HEADER_BOX="tfhd",t.BOX_TYPE_TRACK_RUN_BOX="trun",t.BOX_TYPE_TRACK_FRAGMENT_RANDOM_ACCESS_BOX="tfra",t.BOX_TYPE_MOVIE_FRAGMENT_RANDOM_ACCESS_OFFSET_BOX="mfro",t.BOX_TYPE_SAMPLE_DEPENDENCY_TYPE_BOX="sdtp",t.BOX_TYPE_SAMPLE_TO_GROUPE_BOX="sbgp",t.BOX_TYPE_SAMPLE_GROUP_DESCRIPTION_BOX="sgpd",t.BOX_TYPE_ROLL_RECOVERY_ENTRY="roll",t.BOX_TYPE_SAMPLE_SCALE_BOX="stsl",t.BOX_TYPE_SUB_SAMPLE_INFORMATION_BOX="subs",t.BOX_TYPE_PROGRESSIVE_DOWNLOAD_INFO_BOX="pdin",t.BOX_TYPE_META_BOX="meta",t.BOX_TYPE_XML_BOX="xml ",t.BOX_TYPE_BINARY_XML_BOX="bxml",t.BOX_TYPE_ITEM_LOCATION_BOX="iloc",t.BOX_TYPE_PRIMARY_ITEM_BOX="pitm",t.BOX_TYPE_ITEM_PROTECTION_BOX="ipro",t.BOX_TYPE_ITEM_INFO_ENTRY="infe",t.BOX_TYPE_ITEM_INFO_BOX="iinf",t.BOX_TYPE_PROTECTION_SCHEME_INFO_BOX="sinf",t.BOX_TYPE_ORIGINAL_FORMAT_BOX="frma",t.BOX_TYPE_IPMP_INFO_BOX="imif",t.BOX_TYPE_IPMP_CONTROL_BOX="impc",t.DESCR_TAG_ES_DESCRIPTOR=3,t.DESCR_TAG_DECODER_CONFIG_DESCRIPTOR=4,t.DESCR_TAG_DECODER_SPECIFIC_INFO=5,t.DESCR_TAG_SL_CONFIG_DESCRIPTOR=6,t.DESCR_TAG_PROFILE_LEVEL_INDICATION_INDEX_DESCRIPTOR=20},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=Object.prototype.toString;let i=new Uint8Array(32768),a=new Uint16Array(i.buffer),n=new Uint32Array(i.buffer);const o=e=>{const t=i.byteLength+e;let s=i.byteLength;for(;s<t;)s*=2;const r=new Uint8Array(s);r.set(i),i=r,a=new Uint16Array(r.buffer),n=new Uint32Array(r.buffer)};class l{constructor(e,t,s){if("number"==typeof e)this.view=new DataView(new ArrayBuffer(e));else switch(r.call(e)){case"[object ArrayBuffer]":t=t||0,s=s||e.byteLength,this.view=new DataView(e,t,s);break;case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object CanvasPixelArray]":case"[object Int8Array]":case"[object Uint16Array]":case"[object Int16Array]":case"[object Uint32Array]":case"[object Int32Array]":case"[object Float32Array]":case"[object Float64Array]":case"[object DataView]":this.view=void 0===t&&void 0===s?new DataView(e.buffer,e.byteOffset,e.byteLength):void 0!==t&&void 0===s?new DataView(e.buffer,e.byteOffset+t):void 0===t&&void 0!==s?new DataView(e.buffer,e.byteOffset,s):new DataView(e.buffer,t,s);break;default:throw new TypeError}this.buffer=this.view.buffer,this.byteOffset=this.view.byteOffset,this.byteLength=this.view.byteLength}getUint8(e){return this.view.getUint8(e)}setUint8(e,t){this.view.setUint8(e,t)}getInt8(e){return this.view.getInt8(e)}setInt8(e,t){this.view.setInt8(e,t)}getUint16(e,t=!1){return this.view.getUint16(e,t)}setUint16(e,t,s=!1){this.view.setUint16(e,t,s)}getInt16(e,t=!1){return this.view.getInt16(e,t)}setInt16(e,t,s=!1){this.view.setInt16(e,t,s)}getUint32(e,t=!1){return this.view.getUint32(e,t)}setUint32(e,t,s=!1){this.view.setUint32(e,t,s)}getInt32(e,t=!1){return this.view.getInt32(e,t)}setInt32(e,t,s=!1){this.view.setInt32(e,t,s)}getFloat32(e,t=!1){return this.view.getFloat32(e,t)}setFloat32(e,t,s=!1){this.view.setFloat32(e,t,s)}getFloat64(e,t=!1){return this.view.getFloat64(e,t)}setFloat64(e,t,s=!1){this.view.setFloat64(e,t,s)}getString(e,t){const s=new Uint8Array(this.buffer,this.byteOffset+e,t);return String.fromCharCode.apply(null,s)}setString(e,t){const s=new Uint8Array(this.buffer,this.byteOffset+e);let r=t.length;for(;r;)s[--r]=t.charCodeAt(r)}getUTF8String(e,t){const s=new Uint8Array(this.buffer,this.byteOffset+e,this.byteLength);return l.UTF8BytesToString(s)}static stringToUTF8Bytes(e){let t,s,r=e.length,a=-1,n=i,l=n.byteLength;for(t=0;t<r;++t)(s=e.charCodeAt(t))<=127?n[++a]=s:s<=2047?(n[++a]=192|s>>>6,n[++a]=128|63&s):s<=65535?(n[++a]=224|s>>>12,n[++a]=128|s>>>6&63,n[++a]=128|63&s):(n[++a]=240|s>>>18,n[++a]=128|s>>>12&63,n[++a]=128|s>>>6&63,n[++a]=128|63&s),l-a<=4&&(o(4),n=i);const h=new Uint8Array(++a);return h.set(n.subarray(0,a)),h}static UTF8BytesToString(e){const t=e.byteLength,s=n;let r,i=0,a=0,o="";for(;a<t;){for(i=0;i<4096&&a<t;++a,++i)(r=e[a])<128?s[i]=r:r>>>5==6?(s[i]=(31&r)<<6,s[i]|=63&e[++a]):r>>>4==14?(s[i]=(15&r)<<12,s[i]|=(63&e[++a])<<6,s[i]|=63&e[++a]):(s[i]=(7&r)<<18,s[i]|=(63&e[++a])<<12,s[i]|=(63&e[++a])<<6,s[i]|=63&e[++a]);o+=String.fromCharCode.apply(null,s.subarray(0,i))}return o}setUTF8String(e,t){const s=l.stringToUTF8Bytes(t);return new Uint8Array(this.buffer,this.byteOffset,this.byteLength).set(s,e),s.length}getUint24(e,t=!1){const s=new Uint8Array(this.buffer,this.byteOffset+e);return t?s[0]|s[1]<<8|s[2]<<16:s[2]|s[1]<<8|s[0]<<16}setUint24(e,t,s=!1){const r=new Uint8Array(this.buffer,this.byteOffset+e);s?(r[0]=255&t,r[1]=(65280&t)>>8,r[2]=(16711680&t)>>16):(r[2]=255&t,r[1]=(65280&t)>>8,r[0]=(16711680&t)>>16)}getInt24(e,t=!1){const s=this.getUint24(e,t);return 8388608&s?s-16777216:s}setInt24(e,t,s=!1){this.setUint24(e,t,s)}}t.DataView2=l},function(e,t,s){"use strict";var r=this&&this.__decorate||function(e,t,s,r){var i,a=arguments.length,n=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,s,r);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(n=(a<3?i(n):a>3?i(t,s,n):i(t,s))||n);return a>3&&n&&Object.defineProperty(t,s,n),n};Object.defineProperty(t,"__esModule",{value:!0});const i=s(10),a=s(0),n={};function o(e){return function(t){return t.TAG=e,"number"==typeof e?n[e]=t:e.forEach(e=>n[e]=t),t}}t.getDescriptorInfo=((e,t=0)=>{for(var s=e[t++],r=e[t++],i=127&r,a=2;128&r;)a++,i<<=7,i|=127&(r=e[t++]);return{tag:s,byteLength:a+i,headerLength:a,bodyLength:i}});class l extends i.BaseParser{readDescriptor(){var e=t.getDescriptorInfo(this.bytes,this.byteOffset);return t.createDescriptorParser(this.readBytes(e.byteLength),e.tag).parse()}}t.DescriptorParserMixin=l;class h extends l{parse(){var e=t.getDescriptorInfo(this.bytes);return this.skipBytes(e.headerLength),e.bytes=this.bytes,e}}t.DescriptorParser=h;let _=class extends h{parse(){var e=super.parse();return e.data=this.bytes.subarray(this.byteOffset),e}};_=r([o(a.DESCR_TAG_DECODER_SPECIFIC_INFO)],_),t.DecoderSpecificInfoParser=_;let d=class extends h{parse(){var e=super.parse();return e.profileLevelIndicationIndex=this.readUint8(),e}};d=r([o(a.DESCR_TAG_PROFILE_LEVEL_INDICATION_INDEX_DESCRIPTOR)],d),t.ProfileLevelINdicationIndexDescriptor=d;let B=class extends h{parse(){var e,s,r,i=super.parse();for(i.objectTypeIndication=this.readUint8(),i.streamType=this.readBits(6),i.upStream=this.readBits(1),this.skipBits(1),i.bufferSizeDB=this.readUint24(),i.maxBitrate=this.readUint32(),i.avgBitrate=this.readUint32(),i.profileLevelIndicationIndexDescrs=[];!this.eof();)if(e=t.getDescriptorInfo(this.bytes.subarray(this.byteOffset)),r=(s=t.createDescriptorParser(this.readBytes(e.byteLength),e.tag)).parse(),s instanceof _)i.decSpecificInfo=r;else{if(!(s instanceof d))throw new TypeError;i.profileLevelIndicationIndexDescrs.push(r)}return i}};B.OBJECT_TYPE_INDICATION={MP3:107,AAC:64},B=r([o(a.DESCR_TAG_DECODER_CONFIG_DESCRIPTOR)],B),t.DecoderConfigDescriptorParser=B;let u=class extends h{parse(){var e=super.parse();return e.preDefined=this.readUint8(),0===e.preDefined&&(e.useAccessUnitStartFlag=this.readBits(1),e.useAccessUnitEndFlag=this.readBits(1),e.useRandomAccessPointFlag=this.readBits(1),e.hasRandomAccessUnitsOnlyFlag=this.readBits(1),e.usePaddingFlag=this.readBits(1),e.useTimeStampsFlag=this.readBits(1),e.useIdleFlag=this.readBits(1),e.durationFlag=this.readBits(1),e.timeStampResolution=this.readUint32(),e.ocrResolution=this.readUint32(),e.timeStampLength=this.readUint8(),e.ocrLength=this.readUint8(),e.auLength=this.readUint8(),e.instantBitrateLength=this.readUint8(),e.degradationPriorityLength=this.readBits(4),e.auSeqNumLength=this.readBits(5),e.packetSeqNumLength=this.readBits(5),this.skipBits(2)),e.durationFlag&&(e.timeScale=this.readUint32(),e.accessUnitDuration=this.readUint16(),e.compositionUnitDuration=this.readUint16()),0===e.useTimeStampsFlag&&(e.startDecodingTimeStamp=this.readBits(e.timeStampLength),e.startCompositionTimeStamp=this.readBits(e.timeStampLength)),e}};u=r([o(a.DESCR_TAG_SL_CONFIG_DESCRIPTOR)],u),t.SLConfigDescriptorParser=u;t.IPIDescriptorPointerParser=class extends h{};t.IPIdentificationDataSetParser=class extends h{};t.IPMPDescriptorPointerParser=class extends h{};t.LanguageDescriptorParser=class extends h{};t.QosDescriptorParser=class extends h{};t.ExtensionDescriptorParser=class extends h{};let c=class extends h{parse(){var e,t=super.parse();for(t.esID=this.readUint16(),t.streamDependenceFlag=this.readBits(1),t.urlFlag=this.readBits(1),t.ocrStreamFlag=this.readBits(1),t.streamPriority=this.readBits(5),t.streamDependenceFlag&&(t.dependsOnEsID=this.readUint16()),t.urlFlag&&(t.urlLength=this.readUint8(),t.urlString=this.readString(t.urlLength)),t.ocrStreamFlag&&(t.ocrEsID=this.readUint16());!this.eof();)switch((e=this.readDescriptor()).tag){case a.DESCR_TAG_DECODER_CONFIG_DESCRIPTOR:t.decConfigDescr=e;break;case a.DESCR_TAG_SL_CONFIG_DESCRIPTOR:t.slConfigDescr=e}return t}};c=r([o(a.DESCR_TAG_ES_DESCRIPTOR)],c),t.ESDescriptorParser=c;let p=class extends h{parse(){var e=super.parse();if(e.objectDescrID=this.readBits(10),e.urlFlag=this.readBits(1),e.includeInlineProfileLevelFlag=this.readBits(1),this.skipBits(4),e.urlFlag?(e.urlLength=this.readUint8(),e.urlString=this.readString(e.urlLength)):(e.odProfileLevelIndication=this.readUint8(),e.sceneProfileLevelIndication=this.readUint8(),e.audioProfileLevelIndication=this.readUint8(),e.visualProfileLevelIndication=this.readUint8(),e.graphicsProfileLevelIndication=this.readUint8()),e.extDescrs=[],e.urlFlag)for(;!this.eof();)e.extDescrs.push(this.readDescriptor());return e}};p=r([o([2,16])],p),t.InitialObjectDescriptorParser=p,t.createDescriptorParser=((e,t)=>new(n[t]||h)(e))},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(1),i=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215,33554431],a=Math.pow(2,25),n=Math.pow(2,32);t.BitReader=class{constructor(e,t=!1){this.bytes=e,this.littleEndian=t,this.bitOffset=0,this.view=new r.DataView2(e)}readBits(e){if(e<=0)throw new Error;let t,s,r,n=0;for(;e>0;){switch(r=e>25?25:e,n*=a,s=Math.ceil((this.bitOffset%8+r)/8)){case 1:t=this.view.getUint8(this.byteOffset);break;case 2:t=this.view.getUint16(this.byteOffset);break;case 3:t=this.view.getUint24(this.byteOffset);break;case 4:t=this.view.getUint32(this.byteOffset)}n+=t>>>8*s-(this.bitOffset%8+r)&i[r],this.skipBits(r),e-=r}return n}readUint8(){const e=this.view.getUint8(this.byteOffset);return this.skipBytes(1),e}readInt8(){const e=this.view.getInt8(this.byteOffset);return this.skipBytes(1),e}readUint16(){const e=this.view.getUint16(this.byteOffset,this.littleEndian);return this.skipBytes(2),e}readInt16(){const e=this.view.getInt16(this.byteOffset,this.littleEndian);return this.skipBytes(2),e}readUint24(){const e=this.view.getUint24(this.byteOffset,this.littleEndian);return this.skipBytes(3),e}readInt24(){const e=this.view.getInt24(this.byteOffset,this.littleEndian);return this.skipBytes(3),e}readUint32(){const e=this.view.getUint32(this.byteOffset,this.littleEndian);return this.skipBytes(4),e}readUint64(){return this.readUint32()*n+this.readUint32()}readInt32(){const e=this.view.getInt32(this.byteOffset,this.littleEndian);return this.skipBytes(4),e}readFloat32(){const e=this.view.getFloat32(this.byteOffset,this.littleEndian);return this.skipBytes(4),e}readFloat64(){const e=this.view.getFloat64(this.byteOffset,this.littleEndian);return this.skipBytes(8),e}readBytes(e){const t=this.byteOffset,s=this.bytes.subarray(t,t+e);return this.skipBytes(e),s}readString(e=0){let t;if(0===e){const s=this.bytes.subarray(this.byteOffset);t=String.fromCharCode.apply(null,s),e=s.length}else t=this.view.getString(this.byteOffset,e);return this.skipBytes(e),t}readStringNullTerminated(){const e=this.bytes.subarray(this.byteOffset);let t=0;if(!e.byteLength)return"";for(;0!==e[t++];);return this.skipBytes(t),String.fromCharCode.apply(null,e.subarray(0,t-1))}readUTF8StringNullTerminated(){const e=this.bytes.subarray(this.byteOffset);let t=0;if(!e.byteLength)return"";for(;0!==e[t++];);return this.skipBytes(t),r.DataView2.UTF8BytesToString(e.subarray(0,t-1))}skipBits(e){this.bitOffset+=e}skipBytes(e){this.bitOffset+=8*e}get byteOffset(){return this.bitOffset>>>3}eof(){return this.bitOffset/8>=this.bytes.length}}},function(e,t,s){"use strict";var r=this&&this.__decorate||function(e,t,s,r){var i,a=arguments.length,n=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,s,r);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(n=(a<3?i(n):a>3?i(t,s,n):i(t,s))||n);return a>3&&n&&Object.defineProperty(t,s,n),n};Object.defineProperty(t,"__esModule",{value:!0});const i=s(9),a=s(0),n={};function o(e){return function(t){return t.TAG=e,n[e]=t,t}}class l extends i.BaseBuilder{writeDescriptor(e){var s;s=e instanceof Uint8Array?e:e.bytes?e.bytes:t.createDescriptorBuilder(e).build(),this.writeBytes(s)}}t.DescriptorBuilderMixin=l;class h extends l{constructor(){super(),this.writeUint8(this.constructor.TAG),this.writeBytes(new Uint8Array(4))}build(){return this.writeBodyLength(),super.build()}writeBodyLength(){for(var e=[128,128,128,0],t=this.byteOffset-5,s=3;t;)e[s--]|=127&t,t>>>=7;this.bytes.set(e,1)}}t.DescriptorBuilder=h;let _=class extends h{constructor(e){super(),this.writeUint8(e.objectTypeIndication),this.writeBits(e.streamType,6),this.writeBits(e.upStream,1),this.writeBits(1,1),this.writeUint24(e.bufferSizeDB),this.writeUint32(e.maxBitrate),this.writeUint32(e.avgBitrate),e.decSpecificInfo.tag=a.DESCR_TAG_DECODER_SPECIFIC_INFO,this.writeDescriptor(e.decSpecificInfo),e.profileLevelIndicationIndexDescrs&&e.profileLevelIndicationIndexDescrs.forEach(e=>{e.tag=a.DESCR_TAG_PROFILE_LEVEL_INDICATION_INDEX_DESCRIPTOR,this.writeDescriptor(e)})}};_=r([o(a.DESCR_TAG_DECODER_CONFIG_DESCRIPTOR)],_),t.DecoderConfigDescriptorBuilder=_;let d=class extends h{constructor(e){super(),this.writeUint8(e.preDefined),0===e.preDefined&&(this.writeBits(e.useAccessUnitStartFlag,1),this.writeBits(e.useAccessUnitEndFlag,1),this.writeBits(e.useRandomAccessPointFlag,1),this.writeBits(e.hasRandomAccessUnitsOnlyFlag,1),this.writeBits(e.usePaddingFlag,1),this.writeBits(e.useTimeStampsFlag,1),this.writeBits(e.useTimeStampsFlag,1),this.writeBits(e.useIdleFlag,1),this.writeBits(e.durationFlag,1),this.writeUint32(e.timeStampResolution),this.writeUint32(e.ocrResolution),this.writeUint8(e.timeStampLength),this.writeUint8(e.ocrLength),this.writeUint8(e.auLength),this.writeUint8(e.instantBitrateLength),this.writeBits(e.degradationPriorityLength,4),this.writeBits(e.auSeqNumLength,5),this.writeBits(e.packetSeqNumLength,5),this.writeBits(3,2)),e.durationFlag&&(this.writeUint32(e.timeScale),this.writeUint16(e.accessUnitDuration),this.writeUint16(e.compositionUnitDuration)),0===e.useTimeStampsFlag&&(this.writeBits(e.startDecodingTimeStamp,e.timeStampLength),this.writeBits(e.startCompositionTimeStamp,e.timeStampLength))}};d=r([o(a.DESCR_TAG_SL_CONFIG_DESCRIPTOR)],d),t.SLConfigDescriptorBuilder=d;let B=class extends h{constructor(e){super(),this.writeBytes(e.data)}};B=r([o(a.DESCR_TAG_DECODER_SPECIFIC_INFO)],B),t.DecoderSpecificInfoBuilder=B;let u=class extends h{constructor(e){super(),this.writeUint16(e.esID),this.writeBits(e.streamDependenceFlag||0,1),this.writeBits(e.urlFlag||0,1),this.writeBits(e.ocrStreamFlag||0,1),this.writeBits(e.streamPriority,5),e.urlFlag&&(this.writeUint8(e.urlLength),this.writeString(e.urlString)),e.ocrStreamFlag&&this.writeUint16(e.ocrEsID),e.decConfigDescr.tag=a.DESCR_TAG_DECODER_CONFIG_DESCRIPTOR,this.writeDescriptor(e.decConfigDescr),e.slConfigDescr.tag=a.DESCR_TAG_SL_CONFIG_DESCRIPTOR,this.writeDescriptor(e.slConfigDescr)}};u=r([o(a.DESCR_TAG_ES_DESCRIPTOR)],u),t.ESDescriptorBuilder=u,t.createDescriptorBuilder=(e=>new(n[e.tag]||h)(e))},function(e,t,s){"use strict";var r=this&&this.__decorate||function(e,t,s,r){var i,a=arguments.length,n=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,s,r);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(n=(a<3?i(n):a>3?i(t,s,n):i(t,s))||n);return a>3&&n&&Object.defineProperty(t,s,n),n};Object.defineProperty(t,"__esModule",{value:!0});const i=s(4),a=s(0),n={};function o(e){return function(t){return t.TYPE=e,n[e]=t,t}}class l extends i.DescriptorBuilderMixin{constructor(){super(),this.skipBytes(4),this.writeString(this.constructor.TYPE)}build(){return this.view.setUint32(0,this.byteOffset),super.build()}writeBox(e){var t;t=e instanceof Uint8Array?e:e.bytes?e.bytes:K(e).build(),this.writeBytes(t)}}t.BoxBuilder=l;class h extends l{constructor(e){super(),this.box=e,this.writeUint8(e.version||0),this.writeUint24(e.flags||0)}}t.FullBoxBuilder=h;class _ extends l{constructor(e){super(),e.forEach(e=>this.writeBox(e))}}t.BoxListBuilder=_;let d=class extends l{constructor(e){super(),this.writeString(e.majorBrand),this.writeUint32(e.minorVersion),e.compatibleBrands.forEach(e=>this.writeString(e))}};d=r([o(a.BOX_TYPE_FILE_TYPE_BOX)],d),t.FileTypeBoxBuilder=d;let B=class extends _{};B=r([o(a.BOX_TYPE_MOVIE_BOX)],B),t.MovieBoxBuilder=B;let u=class extends l{constructor(e){super(),this.writeBytes(e.data)}};u=r([o(a.BOX_TYPE_MEDIA_DATA_BOX)],u),t.MediaDataBoxBuilder=u;let c=class extends h{constructor(e){super(e),1===e.version?(this.writeUint64(e.creationTime),this.writeUint64(e.modificationTime),this.writeUint32(e.timescale),this.writeUint64(e.duration)):(this.writeUint32(e.creationTime),this.writeUint32(e.modificationTime),this.writeUint32(e.timescale),this.writeUint32(e.duration)),this.writeInt32(65536*e.rate),this.writeInt16(256*e.volume),this.skipBytes(2),this.skipBytes(8),e.matrix.forEach(e=>this.writeInt32(e)),this.skipBytes(24),this.writeUint32(e.nextTrackID)}};c=r([o(a.BOX_TYPE_MOVIE_HEADER_BOX)],c),t.MovieHeaderBoxBuilder=c;let p=class extends _{};p=r([o(a.BOX_TYPE_TRACK_BOX)],p),t.TrackBoxBuilder=p;let O=class extends h{constructor(e){super(e),e.version,this.writeUint64(e.creationTime),this.writeUint64(e.modificationTime),this.writeUint32(e.trackID),this.skipBytes(4),this.writeUint64(e.duration),this.skipBytes(8),this.writeInt16(e.layer),this.writeInt16(e.alternateGroup),this.writeInt16(256*e.volume),this.skipBytes(2),e.matrix.forEach(e=>this.writeInt32(e)),this.writeUint32(65536*e.width),this.writeUint32(65536*e.height)}};O=r([o(a.BOX_TYPE_TRACK_HEADER_BOX)],O),t.TrackHeaderBoxBuilder=O;let E=class extends _{};E=r([o(a.BOX_TYPE_TRACK_REFERENCE_BOX)],E),t.TrackReferenceBoxBuilder=E;class f extends l{constructor(e){super(),e.trackIDs.forEach(e=>this.writeUint32(e))}}t.TrackReferenceTypeBoxBuilder=f;let T=class extends f{};T=r([o(a.BOX_TYPE_HINT_TRACK_REFERENCE_TYPE_BOX)],T),t.HintTrackReferenceTypeBoxBuilder=T;let P=class extends f{};P=r([o(a.BOX_TYPE_DISCRIBE_TRACK_REFERENCE_TYPE_BOX)],P),t.DescribeTrackReferenceTypeBoxBuilder=P;let y=class extends _{};y=r([o(a.BOX_TYPE_MEDIA_BOX)],y),t.MediaBoxBuilder=y;let m=class extends h{constructor(e){super(e),1===e.version?(this.writeUint64(e.creationTime),this.writeUint64(e.modificationTime),this.writeUint32(e.timescale),this.writeUint64(e.duration)):(this.writeUint32(e.creationTime),this.writeUint32(e.modificationTime),this.writeUint32(e.timescale),this.writeUint32(e.duration)),this.skipBits(1),[].forEach.call(e.language,(t,s)=>{this.writeBits(e.language.charCodeAt(s)-96,5)}),this.skipBytes(2)}};m=r([o(a.BOX_TYPE_MEDIA_HEADER_BOX)],m),t.MediaHeaderBoxBuilder=m;let X=class extends h{constructor(e){super(e),this.skipBytes(4),this.writeString(e.handlerType),this.skipBytes(12),this.writeUTF8StringNullTerminated(e.name)}};X=r([o(a.BOX_TYPE_HANDLER_BOX)],X),t.HandlerBoxBuilder=X;let I=class extends _{};I=r([o(a.BOX_TYPE_MEDIA_INFORMATION_BOX)],I),t.MediaInformationBoxBuilder=I;let U=class extends h{constructor(e){super(e),this.writeUint16(e.graphicsmode),e.opcolor.forEach(e=>this.writeUint16(e))}};U=r([o(a.BOX_TYPE_VIDEO_MEDIA_HEADER_BOX)],U),t.VideoMediaHeaderBoxBuilder=U;let x=class extends h{constructor(e){super(e),this.writeInt16(e.balance),this.skipBytes(2)}};x=r([o(a.BOX_TYPE_SOUND_MEDIA_HEADER_BOX)],x),t.SoundMediaHeaderBoxBuilder=x;let S=class extends h{constructor(e){super(e),this.writeUint16(e.maxPDUsize),this.writeUint16(e.avgPDUsize),this.writeUint32(e.maxbitrate),this.writeUint32(e.avgbitrate),this.skipBytes(4)}};S=r([o(a.BOX_TYPE_HINT_MEDIA_HEADER_BOX)],S),t.HintMediaHeaderBoxBuilder=S;let D=class extends h{};D=r([o(a.BOX_TYPE_NULL_MEDIA_HEADER_BOX)],D),t.NullMediaHeaderBoxBuilder=D;let g=class extends _{};g=r([o(a.BOX_TYPE_DATA_INFORMATION_BOX)],g),t.DataInformationBoxBuilder=g;let w=class extends h{constructor(e){super(e),this.writeUTF8StringNullTerminated(e.location)}};w=r([o(a.BOX_TYPE_DATA_ENTRY_URL_BOX)],w),t.DataEntryUrlBoxBuilder=w;let b=class extends h{constructor(e){super(e),this.writeUTF8StringNullTerminated(e.name),this.writeUTF8StringNullTerminated(e.location)}};b=r([o(a.BOX_TYPE_DATA_ENTRY_URN_BOX)],b),t.DataEntryUrnBoxBuilder=b;let A=class extends h{constructor(e){super(e),this.writeUint32(e.entryCount),e.entries.forEach(e=>this.writeBox(e))}};A=r([o(a.BOX_TYPE_DATA_REFERENCE_BOX)],A),t.DataReferenceBoxBuilder=A;let R=class extends _{};R=r([o(a.BOX_TYPE_SAMPLE_TABLE_BOX)],R),t.SampleTableBoxBuilder=R;let v=class extends h{constructor(e){super(e),this.writeUint32(e.entryCount),e.entries.forEach(e=>{this.writeUint32(e.sampleCount),this.writeUint32(e.sampleDelta)})}};v=r([o(a.BOX_TYPE_TIME_TO_SAMPLE_BOX)],v),t.TimeToSampleBoxBuilder=v;let C=class extends h{constructor(e){super(e),this.writeUint32(e.entryCount),e.entries.forEach(e=>{this.writeUint32(e.sampleCount),this.writeUint32(e.sampleOffset)})}};C=r([o(a.BOX_TYPE_COMPOSITION_OFFSET_BOX)],C),t.CompositionOffsetBoxBuilder=C;class Y extends l{constructor(e){super(),this.skipBytes(6),this.writeUint16(e.dataReferenceIndex)}}t.SampleEntryBuilder=Y;t.HintSampleEntryBuilder=class extends Y{constructor(e){super(e),this.writeBytes(e.data)}};class M extends Y{constructor(e){super(e),this.skipBytes(2),this.skipBytes(2),this.skipBytes(12),this.writeUint16(e.width),this.writeUint16(e.height),this.writeUint32(e.horizresolution),this.writeUint32(e.vertresolution),this.skipBytes(4),this.writeUint16(e.frameCount),this.writeString(e.compressorname),this.writeUint16(e.depth),this.writeInt16(-1)}}t.VisualSampleEntryBuilder=M;let N=class extends M{constructor(e){super(e),e.esBox.type=a.BOX_TYPE_ES_DESCRIPTOR_BOX,this.writeBox(e.esBox)}};N=r([o(a.BOX_TYPE_MP4_VISUAL_SAMPLE_ENTRY)],N),t.MP4VisualSampleEntryBuilder=N;let F=class extends h{constructor(e){super(e),e.esDescr.tag=a.DESCR_TAG_ES_DESCRIPTOR,this.writeDescriptor(e.esDescr)}};F=r([o(a.BOX_TYPE_ES_DESCRIPTOR_BOX)],F),t.ESDBoxBuilder=F;class L extends Y{constructor(e){super(e),this.skipBytes(8),this.writeUint16(e.channelCount),this.writeUint16(e.sampleSize),this.skipBytes(2),this.skipBytes(2),this.writeUint32(65536*e.sampleRate)}}t.AudioSampleEntryBuilder=L;let k=class extends L{constructor(e){super(e),e.esBox.type=a.BOX_TYPE_ES_DESCRIPTOR_BOX,this.writeBox(e.esBox)}};k=r([o(a.BOX_TYPE_MP4_AUDIO_SAMPLE_ENTRY)],k),t.MP4AudioSampleEntryBuilder=k;let H=class extends h{constructor(e){super(e),this.writeUint32(e.entryCount),e.boxes.forEach(e=>this.writeBox(e))}};H=r([o(a.BOX_TYPE_SAMPLE_DESCRIPTION_BOX)],H),t.SampleDescriptionBoxBuilder=H;let G=class extends h{constructor(e){super(e),this.writeUint32(e.sampleSize),this.writeUint32(e.sampleCount),0===e.sampleSize&&e.sampleSizes.forEach(e=>this.writeUint32(e))}};G=r([o(a.BOX_TYPE_SAMPLE_SIZE_BOX)],G),t.SampleSizeBoxBuilder=G;let j=class extends h{constructor(e){super(e),this.writeUint32(e.entryCount),e.entries.forEach(e=>{this.writeUint32(e.firstChunk),this.writeUint32(e.samplesPerChunk),this.writeUint32(e.sampleDescriptionIndex)})}};j=r([o(a.BOX_TYPE_SAMPLE_TO_CHUNK_BOX)],j),t.SampleToChunkBoxBuilder=j;let V=class extends h{constructor(e){super(e),this.writeUint32(e.entryCount),e.chunkOffsets.forEach((e,t)=>this.writeUint32(e))}};V=r([o(a.BOX_TYPE_CHUNK_OFFSET_BOX)],V),t.ChunkOffsetBoxBuilder=V;let z=class extends h{constructor(e){super(e),this.writeUint32(e.entryCount),e.chunkOffsets.forEach((e,t)=>this.writeUint64(e))}};z=r([o(a.BOX_TYPE_CHUNK_OFFSET64_BOX)],z),t.ChunkOffset64BoxBuilder=z;var K=e=>new(n[e.type]||l)(e)},function(e,t,s){"use strict";var r=this&&this.__decorate||function(e,t,s,r){var i,a=arguments.length,n=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,s,r);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(n=(a<3?i(n):a>3?i(t,s,n):i(t,s))||n);return a>3&&n&&Object.defineProperty(t,s,n),n};Object.defineProperty(t,"__esModule",{value:!0});const i=s(1),a=s(2),n=s(0),o={};function l(e){return function(t){return t.TYPE=e,o[e]=t,t}}var h=(e,t=0)=>{var s=new i.DataView2(e,t);return{byteLength:s.getUint32(0),type:s.getString(4,4)}};class _ extends a.DescriptorParserMixin{readBox(){var e=h(this.bytes,this.byteOffset);return t.createBoxParser(this.readBytes(e.byteLength),e.type).parse()}}t.BoxParserMixin=_;t.RootParser=class extends _{parse(){for(var e=[];!this.eof();)e.push(this.readBox());return e}};class d extends _{constructor(e){super(e),this.byteLength=this.bytes.length,this.skipBytes(4),this.type=this.readString(4)}parse(){return{byteLength:this.byteLength,type:this.type,bytes:this.bytes}}}t.BoxParser=d;class B extends d{constructor(e){super(e),this.version=this.readUint8(),this.flags=this.readUint24()}parse(){var e=super.parse();return e.version=this.version,e.flags=this.flags,e}}t.FullBoxParser=B;let u=class extends d{parse(){var e=super.parse();for(e.majorBrand=this.readString(4),e.minorVersion=this.readUint32(),e.compatibleBrands=[];!this.eof();)e.compatibleBrands.push(this.readString(4));return e}};u=r([l(n.BOX_TYPE_FILE_TYPE_BOX)],u),t.FileTypeBoxParser=u;class c extends d{parse(){for(var e=super.parse(),t=[];!this.eof();)t.push(this.readBox());return e.boxes=t,e}}t.BoxListParser=c;let p=class extends c{};p=r([l(n.BOX_TYPE_MOVIE_BOX)],p),t.MovieBoxParser=p;let O=class extends d{parse(){var e=super.parse();return e.data=this.bytes.subarray(8),e}};O=r([l(n.BOX_TYPE_MEDIA_DATA_BOX)],O),t.MediaDataBoxParser=O;let E=class extends B{parse(){var e=super.parse();e.matrix=[],1===this.version?(e.creationTime=this.readUint64(),e.modificationTime=this.readUint64(),e.timescale=this.readUint32(),e.duration=this.readUint64()):(e.creationTime=this.readUint32(),e.modificationTime=this.readUint32(),e.timescale=this.readUint32(),e.duration=this.readUint32()),e.rate=this.readUint32(),e.volume=this.readUint16(),this.skipBytes(2),this.skipBytes(8);for(var t=0;t<9;++t)e.matrix.push(this.readInt32());return this.skipBytes(24),e.nextTrackID=this.readUint32(),e}};E=r([l(n.BOX_TYPE_MOVIE_HEADER_BOX)],E),t.MovieHeaderBoxParser=E;let f=class extends c{};f=r([l(n.BOX_TYPE_TRACK_BOX)],f),t.TrackBoxParser=f;let T=class extends B{parse(){var e=super.parse();e.matrix=[],1===this.version?(e.creationTime=this.readUint64(),e.modificationTime=this.readUint64(),e.trackID=this.readUint32(),this.skipBytes(4),e.duration=this.readUint64()):(e.creationTime=this.readUint32(),e.modificationTime=this.readUint32(),e.trackID=this.readUint32(),this.skipBytes(4),e.duration=this.readUint32()),this.skipBytes(8),e.layer=this.readInt16(),e.alternateGroup=this.readInt16(),e.volume=this.readInt16()/256,this.skipBytes(2);for(var t=0;t<9;++t)e.matrix.push(this.readInt32());return e.width=this.readUint32()/65536,e.height=this.readUint32()/65536,e}};T=r([l(n.BOX_TYPE_TRACK_HEADER_BOX)],T),t.TrackHeaderBoxParser=T;let P=class extends c{};P=r([l(n.BOX_TYPE_TRACK_REFERENCE_BOX)],P),t.TrackReferenceBox=P;class y extends d{parse(){var e=super.parse();for(e.trackIDs=[];!this.eof();)e.trackIDs.push(this.readUint32());return e}}t.TrackReferenceTypeBox=y;let m=class extends y{};m=r([l(n.BOX_TYPE_HINT_TRACK_REFERENCE_TYPE_BOX)],m),t.HintTrackReferenceTypeBox=m;let X=class extends y{};X=r([l(n.BOX_TYPE_DISCRIBE_TRACK_REFERENCE_TYPE_BOX)],X),t.DescribeTrackReferenceTypeBox=X;let I=class extends c{};I=r([l(n.BOX_TYPE_MEDIA_BOX)],I),t.MediaBoxParser=I;let U=class extends B{parse(){var e=super.parse();return 1===this.version?(e.creationTime=this.readUint64(),e.modificationTime=this.readUint64(),e.timescale=this.readUint32(),e.duration=this.readUint64()):(e.creationTime=this.readUint32(),e.modificationTime=this.readUint32(),e.timescale=this.readUint32(),e.duration=this.readUint32()),this.skipBits(1),e.language=String.fromCharCode.apply(null,[this.readBits(5),this.readBits(5),this.readBits(5)].map(e=>e+96)),e}};U=r([l(n.BOX_TYPE_MEDIA_HEADER_BOX)],U),t.MediaHeaderBoxParser=U;let x=class extends B{parse(){var e=super.parse();return this.skipBytes(4),e.handlerType=this.readString(4),this.skipBytes(12),e.name=this.readUTF8StringNullTerminated(),e}};x=r([l(n.BOX_TYPE_HANDLER_BOX)],x),t.HandlerBoxParser=x;let S=class extends c{};S=r([l(n.BOX_TYPE_MEDIA_INFORMATION_BOX)],S),t.MediaInformationBoxParser=S;let D=class extends B{parse(){var e=super.parse();new i.DataView2(this.bytes);e.opcolor=[],e.graphicsmode=this.readUint16();for(var t=0;t<3;++t)e.opcolor.push(this.readUint16());return e}};D=r([l(n.BOX_TYPE_VIDEO_MEDIA_HEADER_BOX)],D),t.VideoMediaHeaderBoxParser=D;let g=class extends B{parse(){var e=super.parse();return e.balance=this.readInt16(),e}};g=r([l(n.BOX_TYPE_SOUND_MEDIA_HEADER_BOX)],g),t.SoundMediaHeaderBoxParser=g;let w=class extends B{parse(){var e=super.parse();return e.maxPDUsize=this.readUint16(),e.avgPDUsize=this.readUint16(),e.maxbitrate=this.readUint32(),e.avgbitrate=this.readUint32(),e}};w=r([l(n.BOX_TYPE_HINT_MEDIA_HEADER_BOX)],w),t.HintMediaHeaderBoxParser=w;let b=class extends B{};b=r([l(n.BOX_TYPE_NULL_MEDIA_HEADER_BOX)],b),t.NullMediaHeaderBoxParser=b;let A=class extends c{};A=r([l(n.BOX_TYPE_DATA_INFORMATION_BOX)],A),t.DataInformationBoxParser=A;let R=class extends B{parse(){var e=super.parse();for(e.entryCount=this.readUint32(),e.entries=[];!this.eof();)e.entries.push(this.readBox());return e}};R=r([l(n.BOX_TYPE_DATA_REFERENCE_BOX)],R),t.DataReferenceBoxParser=R;let v=class extends B{parse(){var e=super.parse();return e.location=this.readUTF8StringNullTerminated(),e}};v=r([l(n.BOX_TYPE_DATA_ENTRY_URL_BOX)],v),t.DataEntryUrlBoxParser=v;let C=class extends B{parse(){var e=super.parse();return e.name=this.readUTF8StringNullTerminated(),e.location=this.readUTF8StringNullTerminated(),e}};C=r([l(n.BOX_TYPE_DATA_ENTRY_URN_BOX)],C),t.DataEntryUrnBoxParser=C;let Y=class extends c{};Y=r([l(n.BOX_TYPE_SAMPLE_TABLE_BOX)],Y),t.SampleTableBoxParser=Y;let M=class extends B{parse(){var e=super.parse(),t=this.readUint32();e.entryCount=t,e.entries=[];for(var s=0;s<t;++s)e.entries.push({sampleCount:this.readUint32(),sampleDelta:this.readUint32()});return e}};M=r([l(n.BOX_TYPE_TIME_TO_SAMPLE_BOX)],M),t.TimeToSampleBoxParser=M;let N=class extends B{parse(){var e=super.parse(),t=this.readUint32();e.entryCount=t,e.entries=[];for(var s=0;s<t;++s)e.entries.push({sampleCount:this.readUint32(),sampleOffset:this.readUint32()});return e}};N=r([l(n.BOX_TYPE_COMPOSITION_OFFSET_BOX)],N),t.CompositionOffsetBoxParser=N;class F extends d{parse(){var e=super.parse();return this.skipBytes(6),e.dataReferenceIndex=this.readUint16(),e}}t.SampleEntryParser=F;t.HintSampleEntryParser=class extends F{parse(){var e=super.parse();return e.data=this.bytes.subarray(16),e}};class L extends F{parse(){var e=super.parse();return this.skipBytes(16),e.width=this.readUint16(),e.height=this.readUint16(),e.horizresolution=this.readUint32(),e.vertresolution=this.readUint32(),e.compressorname=this.readString(32),e.depth=this.readUint16(),e}}t.VisualSampleEntryParser=L;class k extends F{parse(){var e=super.parse();return this.skipBytes(8),e.channelCount=this.readUint16(),e.sampleSize=this.readUint16(),this.skipBytes(4),e.sampleRate=this.readUint32()/65536,e}}t.AudioSampleEntryParser=k;let H=class extends B{parse(){var e=super.parse();return e.esDescr=this.readDescriptor(),e}};H=r([l(n.BOX_TYPE_ES_DESCRIPTOR_BOX)],H),t.ESDBoxParser=H;let G=class extends L{parse(){var e=super.parse();return e.esBox=this.readBox(),e}};G=r([l(n.BOX_TYPE_MP4_VISUAL_SAMPLE_ENTRY)],G),t.MP4VisualSampleEntryParser=G;let j=class extends k{parse(){var e=super.parse();return e.esBox=this.readBox(),e}};j=r([l(n.BOX_TYPE_MP4_AUDIO_SAMPLE_ENTRY)],j),t.MP4AudioSampleEntryParser=j;let V=class extends F{parse(){var e=super.parse();return e.esBox=this.readBox(),e}};V=r([l(n.BOX_TYPE_MPEG_SAMPLE_ENTRY)],V),t.MpegSampleEntryParser=V;let z=class extends B{parse(){var e=super.parse(),t=this.readUint32();e.entryCount=t,e.boxes=[];for(var s=0;s<t;++s)e.boxes.push(this.readBox());return e}};z=r([l(n.BOX_TYPE_SAMPLE_DESCRIPTION_BOX)],z),t.SampleDescriptionBoxParser=z;let K=class extends B{parse(){var e=super.parse(),t=this.readUint32(),s=this.readUint32();if(0===t){e.sampleSizes=[];for(var r=0;r<s;++r)e.sampleSizes.push(this.readUint32())}return e.sampleSize=t,e.sampleCount=s,e}};K=r([l(n.BOX_TYPE_SAMPLE_SIZE_BOX)],K),t.SampleSizeBoxParser=K;let W=class extends B{parse(){var e=super.parse(),t=this.readUint32();e.entryCount=t,e.entries=[];for(var s=0;s<t;++s)e.entries.push({firstChunk:this.readUint32(),samplesPerChunk:this.readUint32(),sampleDescriptionIndex:this.readUint32()});return e}};W=r([l(n.BOX_TYPE_SAMPLE_TO_CHUNK_BOX)],W),t.SampleToChunkBoxParser=W;let q=class extends B{parse(){var e=super.parse(),t=this.readUint32();e.entryCount=t,e.chunkOffsets=[];for(var s=0;s<t;++s)e.chunkOffsets.push(this.readUint32());return e}};q=r([l(n.BOX_TYPE_CHUNK_OFFSET_BOX)],q),t.ChunkOffsetBoxParser=q;let Z=class extends B{parse(){var e=super.parse(),t=this.readUint32();e.entryCount=t,e.chunkOffsets=[];for(var s=0;s<t;++s)e.chunkOffsets.push(this.readUint64());return e}};Z=r([l(n.BOX_TYPE_CHUNK_OFFSET64_BOX)],Z),t.ChunkOffset64BoxParser=Z;let J=class extends B{parse(){var e=super.parse(),t=this.readUint32();e.entryCount=t,e.sampleNumbers=[];for(var s=0;s<t;++s)e.sampleNumbers.push(this.readUint32());return e}};J=r([l(n.BOX_TYPE_SYNC_SAMPLE_BOX)],J),t.SyncSampleBoxParser=J;let Q=class extends B{parse(){var e=super.parse(),t=this.readUint32();e.entryCount=t,e.entries=[];for(var s=0;s<t;++s)e.entries.push({shadowedSampleNumber:this.readUint32(),syncSampleNumber:this.readUint32()});return e}};Q=r([l(n.BOX_TYPE_SHADOW_SYNC_SAMPLE_BOX)],Q),t.ShadowSyncSampleBoxParser=Q;let $=class extends B{parse(){var e=super.parse();for(e.priorities=[];!this.eof();)e.priorities.push(this.readUint16());return e}};$=r([l(n.BOX_TYPE_DEGRADATION_PRIORITY_BOX)],$),t.DegradationPriorityBoxParser=$;let ee=class extends B{parse(){var e,t,s=super.parse(),r=this.readUint32();s.sampleCount=r,s.samples=[];for(var i=0;i<r;++i)this.skipBits(1),e=this.readBits(3),this.skipBits(1),t=this.readBits(3),s.samples.push({pad1:e,pad2:t});return s}};ee=r([l(n.BOX_TYPE_PADDING_BITS_BOX)],ee),t.PaddingBitsBoxParser=ee;let te=class extends I{};te=r([l(n.BOX_TYPE_FREE_SPACE_BOX)],te),t.FreeSpaceBoxParser=te;let se=class extends I{};se=r([l(n.BOX_TYPE_SKIP_BOX)],se),t.SkipBoxParser=se;let re=class extends c{};re=r([l(n.BOX_TYPE_EDIT_BOX)],re),t.EditBoxParser=re;let ie=class extends B{parse(){var e=super.parse(),t=this.readUint32();e.entryCount=t,e.entries=[];for(var s=0;s<t;++s)1===this.version?e.entries.push({sagmentDuration:this.readUint64(),mediaTime:this.readUint64(),mediaRateInteger:this.readUint16()}):e.entries.push({sagmentDuration:this.readUint32(),mediaTime:this.readUint32(),mediaRateInteger:this.readUint16()}),this.skipBytes(2);return e}};ie=r([l(n.BOX_TYPE_EDIT_LIST_BOX)],ie),t.EditListBoxParser=ie;let ae=class extends B{parse(){var e=super.parse();return this.skipBits(1),e.language=String.fromCharCode(this.readBits(5),this.readBits(5),this.readBits(5)),e.notice=this.readUTF8StringNullTerminated(),e}};ae=r([l(n.BOX_TYPE_COPYRIGHT_BOX)],ae),t.CopyrightBoxParser=ae;let ne=class extends c{};ne=r([l(n.BOX_TYPE_MOVIE_EXTENDS_BOX)],ne),t.MovieExtendsBoxParser=ne;let oe=class extends B{parse(){var e=super.parse();return e.fragmentDuration=1===this.version?this.readUint64():this.readUint32(),e}};oe=r([l(n.BOX_TYPE_MOVIE_EXTENDS_HEADER_BOX)],oe),t.MovieExtendsHeaderBoxParser=oe;let le=class extends B{parse(){var e=super.parse();return e.trackID=this.readUint32(),e.defaultSampleDescriptionIndex=this.readUint32(),e.defaultSampleDuration=this.readUint32(),e.defaultSampleSize=this.readUint32(),e.defaultSampleFlags=this.readUint32(),e}};le=r([l(n.BOX_TYPE_TRACK_EXTENDS_BOX)],le),t.TrackExtendsBoxParser=le;let he=class extends c{};he=r([l(n.BOX_TYPE_MOVIE_FLAGMENT_BOX)],he),t.MovieFlagmentBoxParser=he;let _e=class extends B{parse(){var e=super.parse();return e.sequenceNumber=this.readUint32(),e}};_e=r([l(n.BOX_TYPE_MOVIE_FRAGMENT_HEADER_BOX)],_e),t.MovieFragmentHeaderBoxParser=_e;let de=class extends c{};de=r([l(n.BOX_TYPE_TRACK_FRAGMENT_BOX)],de),t.TrackFragmentBoxParser=de;let Be=class extends B{parse(){var e=super.parse();return e.trackID=this.readUint32(),1&e.flags&&(e.baseDataOffset=this.readBytes(8)),2&e.flags&&(e.sampleDescriptionIndex=this.readUint32()),8&e.flags&&(e.defaultSampleDuration=this.readUint32()),16&e.flags&&(e.defaultSampleSize=this.readUint32()),32&e.flags&&(e.defaultSampleFlags=this.readUint32()),e}};Be=r([l(n.BOX_TYPE_TRACK_FRAGMENT_HEADER_BOX)],Be),t.TrackFragmentHeaderBoxParser=Be;let ue=class extends B{parse(){var e=super.parse(),t=this.readUint32();e.sampleCount=t,1&e.flags&&(e.dataOffset=this.readInt32()),4&e.flags&&(e.firstSampleFlats=this.readUint32()),e.samples=[];for(var s=0;s<t;++s)e.samples.push({sampleDuration:256&e.flags?this.readUint32():void 0,sampleSize:512&e.flags?this.readUint32():void 0,sampleFlags:1024&e.flags?this.readUint32():void 0,sampleCompositionTimeOffset:2048&e.flags?this.readUint32():void 0});return e}};ue=r([l(n.BOX_TYPE_TRACK_RUN_BOX)],ue),t.TrackRunBoxParser=ue;let ce=class extends B{parse(){var e=super.parse();e.trackID=this.readUint32(),this.skipBits(26),e.lengthSizeOfTrafNum=this.readBits(2),e.lengthSizeOfTrunNum=this.readBits(2),e.lengthSizeOfSampleNum=this.readBits(2);var t=this.readUint32();e.numberOfEntry=t,e.entries=[];for(var s=0;s<t;++s)e.entries.push({time:1===this.version?this.readUint64():this.readUint32(),moofOffset:1===this.version?this.readUint64():this.readUint32(),trafNumber:this.readBits(8*(e.lengthSizeOfTrafNum+1)),trunNumber:this.readBits(8*(e.lengthSizeOfTrunNum+1)),sampleNumber:this.readBits(8*(e.lengthSizeOfSampleNum+1))});return e}};ce=r([l(n.BOX_TYPE_TRACK_FRAGMENT_RANDOM_ACCESS_BOX)],ce),t.TrackFragmentRandomAccessBoxParser=ce;let pe=class extends B{parse(){var e=super.parse();return e.size=this.readUint32(),e}};pe=r([l(n.BOX_TYPE_MOVIE_FRAGMENT_RANDOM_ACCESS_OFFSET_BOX)],pe),t.MovieFragmentRandomAccessOffsetBoxParser=pe;let Oe=class extends B{parse(){var e=super.parse();for(e.samples=[];!this.eof();)this.skipBits(2),e.samples.push({sampleDependsOn:this.readBits(2),sampleIsDependedOn:this.readBits(2),sampleHasRedundancy:this.readBits(2)});return e}};Oe=r([l(n.BOX_TYPE_SAMPLE_DEPENDENCY_TYPE_BOX)],Oe),t.SampleDependencyTypeBoxParser=Oe;let Ee=class extends B{parse(){var e=super.parse();e.groupintType=this.readUint32();var t=this.readUint32();e.entryCount=t,e.entries=[];for(var s=0;s<t;++s)e.entries.push({sampleCount:this.readUint32(),groupDescriptionIndex:this.readUint32()});return e}};Ee=r([l(n.BOX_TYPE_SAMPLE_TO_GROUPE_BOX)],Ee),t.SampleToGroupBoxParser=Ee;class fe extends d{}t.SampleGroupDescriptionEntryParser=fe;class Te extends fe{}t.VisualSampleGroupEntryParser=Te;t.AudioSampleGroupEntryParser=class extends fe{};t.HintSampleGroupEntryParser=class extends fe{};let Pe=class extends B{parse(){var e=super.parse();e.groupingType=this.readUint32();var t=this.readUint32();e.entryCount=t,e.entries=[];for(var s=0;s<t;++s)e.entries.push(this.readBox());return e}};Pe=r([l(n.BOX_TYPE_SAMPLE_GROUP_DESCRIPTION_BOX)],Pe),t.SampleGroupDescriptionBoxParser=Pe;let ye=class extends Te{parse(){var e=super.parse();return e.rollDistance=this.readInt16(),e}};ye=r([l(n.BOX_TYPE_ROLL_RECOVERY_ENTRY)],ye),t.VisualRollRecoveryEntryParser=ye;let me=class extends Te{parse(){var e=super.parse();return e.rollDistance=this.readInt16(),e}};me=r([l(n.BOX_TYPE_ROLL_RECOVERY_ENTRY)],me),t.AudioRollRecoveryEntryParser=me;let Xe=class extends B{parse(){var e=super.parse();return this.skipBits(7),e.constraintFlag=this.readBits(1),e.scaleMethod=this.readUint8(),e.displayCenterX=this.readInt16(),e.displayCenterY=this.readInt16(),e}};Xe=r([l(n.BOX_TYPE_SAMPLE_SCALE_BOX)],Xe),t.SampleScaleBoxParser=Xe;let Ie=class extends B{parse(){var e=super.parse(),t=this.readUint32();e.entryCount=t,e.entries=[];for(var s=0;s<t;++s){for(var r=this.readUint32(),i=this.readUint16(),a=[],n=0;n<i;++n)a.push({subsampleSize:1===e.version?this.readUint32():this.readUint16(),subsamplePriority:this.readUint8(),discardable:this.readUint8()}),this.skipBytes(4);e.entries.push({sampleDelta:r,subsampleCount:i,samples:a})}return e}};Ie=r([l(n.BOX_TYPE_SUB_SAMPLE_INFORMATION_BOX)],Ie),t.SubSampleInformationBoxParser=Ie;let Ue=class extends B{parse(){var e=super.parse();for(e.entries=[];!this.eof();)e.entries.push({rate:this.readUint32(),initialDelay:this.readUint32()});return e}};Ue=r([l(n.BOX_TYPE_PROGRESSIVE_DOWNLOAD_INFO_BOX)],Ue),t.ProgressiveDownloadInfoBoxParser=Ue;let xe=class extends B{parse(){var e=super.parse();for(e.theHandler=this.readBox(),e.otherBoxes=[];!this.eof();){var t=this.readBox();switch(t.type){case n.BOX_TYPE_PRIMARY_ITEM_BOX:e.primaryResource=t;break;case n.BOX_TYPE_DATA_INFORMATION_BOX:e.fileLocations=t;break;case n.BOX_TYPE_ITEM_LOCATION_BOX:e.itemLocations=t;break;case n.BOX_TYPE_ITEM_INFO_BOX:e.itemInfos=t;break;case n.BOX_TYPE_ITEM_PROTECTION_BOX:e.protections=t;break;case n.BOX_TYPE_IPMP_CONTROL_BOX:e.IPMPControl=t;break;default:e.otherBoxes.push(t)}}return e}};xe=r([l(n.BOX_TYPE_META_BOX)],xe),t.MetaBoxParser=xe;let Se=class extends B{parse(){var e=super.parse(),t=this.bytes.subarray(this.byteOffset);return e.xml=i.DataView2.UTF8BytesToString(t),e}};Se=r([l(n.BOX_TYPE_XML_BOX)],Se),t.XMLBoxParsr=Se;let De=class extends B{parse(){var e=super.parse();return e.data=this.bytes.subarray(this.byteOffset),e}};De=r([l(n.BOX_TYPE_BINARY_XML_BOX)],De),t.BinaryXMLBoxParser=De;let ge=class extends B{parse(){var e=super.parse();e.offsetSize=this.readBits(4),e.lengthSize=this.readBits(4),e.baseOffsetSize=this.readBits(4),this.skipBits(4);var t=e.itemCount=this.readUint16();e.items=[];for(var s=0;s<t;++s){for(var r=this.readUint16(),i=this.readUint16(),a=this.readBits(8*e.baseOffsetSize),n=this.readUint16(),o=[],l=0;l<n;++l)o.push({extentOffset:this.readBits(8*e.offsetSize),extentLength:this.readBits(8*e.lengthSize)});e.items.push({itemID:r,dataReferenceIndex:i,baseOffset:a,extentCount:n,extents:o})}return e}};ge=r([l(n.BOX_TYPE_ITEM_LOCATION_BOX)],ge),t.ItemLocationBoxParser=ge;let we=class extends B{parse(){var e=super.parse();return e.itemID=this.readUint16(),e}};we=r([l(n.BOX_TYPE_PRIMARY_ITEM_BOX)],we),t.PrimaryItemBoxParser=we;let be=class extends B{parse(){var e=super.parse(),t=e.protectionCount=this.readUint16();e.protectionInformations=[];for(var s=0;s<t;++s)e.protectionInformations.push(this.readBox());return e}};be=r([l(n.BOX_TYPE_ITEM_PROTECTION_BOX)],be),t.ItemProtectionBoxParser=be;let Ae=class extends B{parse(){var e=super.parse();return e.itemID=this.readUint16(),e.itemProtectionIndex=this.readUint16(),e.itemName=this.readUTF8StringNullTerminated(),e.contentType=this.readUTF8StringNullTerminated(),e.contentEncoding=this.readString(),e}};Ae=r([l(n.BOX_TYPE_ITEM_INFO_ENTRY)],Ae),t.ItemInfoEntryParser=Ae;let Re=class extends B{parse(){var e=super.parse(),t=e.entryCount=this.readUint16();e.itemInfos=[];for(var s=0;s<t;++s)e.itemInfos.push(this.readBox());return e}};Re=r([l(n.BOX_TYPE_ITEM_INFO_BOX)],Re),t.ItemInfoBoxParser=Re;let ve=class extends d{parse(){var e=super.parse();for(e.originalFormat=this.readBox();!this.eof();){var t=this.readBox();switch(t.type){case n.BOX_TYPE_IPMP_INFO_BOX:e.IPMPDescriptors=t}}return e}};ve=r([l(n.BOX_TYPE_PROTECTION_SCHEME_INFO_BOX)],ve),t.ProtectionSchemeInfoBoxParser=ve;let Ce=class extends d{parse(){var e=super.parse();return e.dataFormat=this.readString(4),e}};Ce=r([l(n.BOX_TYPE_ORIGINAL_FORMAT_BOX)],Ce),t.OriginalFormatBoxParser=Ce;let Ye=class extends B{parse(){var e=super.parse();for(e.ipmpDescrs=[];!this.eof();)e.ipmpDescrs.push(this.readDescriptor());return e}};Ye=r([l(n.BOX_TYPE_IPMP_INFO_BOX)],Ye),t.IPMPInfoBoxParser=Ye,t.createBoxParser=((e,t)=>new(o[t]||d)(e))},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(1),i=Math.pow(2,32);t.BitWriter=class{constructor(e=!1){this.littleEndian=e,this.bitOffset=0,this.bytes=new Uint8Array(2),this.view=new r.DataView2(this.bytes)}get data(){const e=this.byteOffset;if(e>this.bytes.length){const t=new Uint8Array(e);return t.set(this.bytes),t}return this.bytes.subarray(0,e)}get byteOffset(){return this.bitOffset>>>3}skipBits(e){this.bitOffset+=e}skipBytes(e){this.skipBits(8*e)}writeBits(e,t){this.expandBuffer(t);const s=Math.ceil((this.bitOffset%8+t)/8);let r;switch(s){case 1:r=this.view.getUint8(this.byteOffset);break;case 2:r=this.view.getUint16(this.byteOffset);break;case 3:r=this.view.getUint24(this.byteOffset);break;case 4:r=this.view.getUint32(this.byteOffset)}switch(r|=e<<8*s-(this.bitOffset%8+t),s){case 1:this.view.setUint8(this.byteOffset,r);break;case 2:this.view.setUint16(this.byteOffset,r);break;case 3:this.view.setUint24(this.byteOffset,r);break;case 4:this.view.setUint32(this.byteOffset,r)}this.skipBits(t)}writeBytes(e){this.expandBuffer(8*e.length),this.bytes.set(e,this.byteOffset),this.skipBytes(e.length)}writeUint8(e){this.expandBuffer(8),this.view.setUint8(this.byteOffset,e),this.skipBytes(1)}writeInt8(e){this.expandBuffer(8),this.view.setInt8(this.byteOffset,e),this.skipBytes(1)}writeUint16(e){this.expandBuffer(16),this.view.setUint16(this.byteOffset,e,this.littleEndian),this.skipBytes(2)}writeInt16(e){this.expandBuffer(16),this.view.setInt16(this.byteOffset,e,this.littleEndian),this.skipBytes(2)}writeUint24(e){this.expandBuffer(24),this.view.setUint24(this.byteOffset,e,this.littleEndian),this.skipBytes(3)}writeInt24(e){this.expandBuffer(24),this.view.setInt24(this.byteOffset,e,this.littleEndian),this.skipBytes(3)}writeUint32(e){this.expandBuffer(32),this.view.setUint32(this.byteOffset,e,this.littleEndian),this.skipBytes(4)}writeUint64(e){this.expandBuffer(64),this.view.setUint32(this.byteOffset/i,e,this.littleEndian),this.skipBytes(4),this.view.setUint32((4294967295&this.byteOffset)>>>0,e,this.littleEndian),this.skipBytes(4)}writeInt32(e){this.expandBuffer(32),this.view.setInt32(this.byteOffset,e,this.littleEndian),this.skipBytes(4)}writeFloat32(e){this.expandBuffer(32),this.view.setFloat32(this.byteOffset,e,this.littleEndian),this.skipBytes(4)}writeFloat64(e){this.expandBuffer(64),this.view.setFloat64(this.byteOffset,e,this.littleEndian),this.skipBytes(8)}writeString(e){this.expandBuffer(8*e.length),this.view.setString(this.byteOffset,e),this.skipBytes(e.length)}writeStringNullTerminated(e){this.writeString(e+"\0")}writeUTF8String(e){var t=r.DataView2.stringToUTF8Bytes(e);this.expandBuffer(8*t.length),this.writeBytes(t)}writeUTF8StringNullTerminated(e){this.writeUTF8String(e+"\0")}expandBuffer(e){let t=8*this.bytes.length;for(;t<this.bitOffset+e;)t*=2;const s=new Uint8Array(Math.ceil(t/8));s.set(this.bytes),this.bytes=s,this.view=new r.DataView2(s)}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Finder=class{constructor(e){this.tree=e}findOne(e){let t;const s=r=>{if(!t){switch(typeof r){case"number":case"string":case"boolean":return}if(r.type===e)return t=r;r.buffer||Object.keys(r).forEach(e=>{const t=r[e];null!=t&&(Array.isArray(t)?t.some(s):t.type&&s(t))})}};return s(this.tree),t}findAll(e){const t=[],s=r=>{switch(typeof r){case"number":case"string":case"boolean":return}r.type===e&&t.push(r),r.buffer||Object.keys(r).forEach(e=>{const t=r[e];null!=t&&(Array.isArray(t)?t.forEach(s):s(t))})};return s(this.tree),t}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(7);t.BaseBuilder=class extends r.BitWriter{build(){return this.data}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(3);t.BaseParser=class extends r.BitReader{parse(){throw new Error("not implemented error.")}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(6),i=s(8),a=s(0),n=s(5),o=s(2),l=s(3);var h=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3];t.parse=(e=>new r.RootParser(e).parse());var _=(e,t)=>{var s,r,n,o,l,h,_,d,B,u=[],c=new i.Finder(t),p=c.findOne(a.BOX_TYPE_SAMPLE_TO_CHUNK_BOX),O=c.findOne(a.BOX_TYPE_SAMPLE_SIZE_BOX),E=c.findOne(a.BOX_TYPE_CHUNK_OFFSET_BOX);for(E||(E=c.findOne(a.BOX_TYPE_CHUNK_OFFSET64_BOX)),s=0,o=0,l=p.entryCount;s<l;++s)for(r=p.entries[s].firstChunk-1,h=s+1<l?p.entries[s+1].firstChunk-1:E.chunkOffsets.length;r<h;++r){for(d=B=E.chunkOffsets[r],n=0,_=p.entries[s].samplesPerChunk;n<_;++n,++o)B+=O.sampleSizes[o];u.push(e.subarray(d,B))}return u},d=e=>{var t;return new i.Finder(e).findAll(a.BOX_TYPE_TRACK_BOX).some(e=>{return"soun"===new i.Finder(e).findOne(a.BOX_TYPE_HANDLER_BOX).handlerType&&(t=e,!0)}),t},B=e=>{var t,s,r=0,i=0;for(t=0,s=e.length;t<s;++t)r+=e[t].length;var a=new Uint8Array(r);for(t=0;t<s;++t)a.set(e[t],i),i+=e[t].length;return a};t.extractAudio=(e=>{var s=t.parse(e),r=new i.Finder(s),o=48,l={majorBrand:"M4A ",minorVersion:1,compatibleBrands:["isom","M4A ","mp42"]};l.bytes=new n.FileTypeBoxBuilder(l).build(),o+=l.bytes.length;var h=r.findOne(a.BOX_TYPE_MOVIE_HEADER_BOX);o+=h.bytes.length;var u=d(s),c=(r=new i.Finder(u)).findOne(a.BOX_TYPE_TRACK_HEADER_BOX);o+=c.bytes.length;var p=(r=new i.Finder(r.findOne(a.BOX_TYPE_MEDIA_BOX))).findOne(a.BOX_TYPE_MEDIA_HEADER_BOX),O=r.findOne(a.BOX_TYPE_HANDLER_BOX);o+=p.bytes.length+O.bytes.length;var E=(r=new i.Finder(r.findOne(a.BOX_TYPE_MEDIA_INFORMATION_BOX))).findOne(a.BOX_TYPE_SOUND_MEDIA_HEADER_BOX),f=r.findOne(a.BOX_TYPE_DATA_INFORMATION_BOX);o+=E.bytes.length+f.bytes.length;var T=(r=new i.Finder(r.findOne(a.BOX_TYPE_SAMPLE_TABLE_BOX))).findOne(a.BOX_TYPE_SAMPLE_DESCRIPTION_BOX),P=r.findOne(a.BOX_TYPE_TIME_TO_SAMPLE_BOX),y=r.findOne(a.BOX_TYPE_SAMPLE_TO_CHUNK_BOX),m=r.findOne(a.BOX_TYPE_SAMPLE_SIZE_BOX),X=r.findOne(a.BOX_TYPE_CHUNK_OFFSET_BOX);X||(X=r.findOne(a.BOX_TYPE_CHUNK_OFFSET64_BOX));var I=X.bytes;o+=T.bytes.length+P.bytes.length+y.bytes.length+m.bytes.length+I.length;for(var U=_(e,u),x=[o],S=1,D=U.length;S<D;++S)o+=U[S-1].length,x[S]=o;I=new(X.type===a.BOX_TYPE_CHUNK_OFFSET_BOX?n.ChunkOffsetBoxBuilder:n.ChunkOffset64BoxBuilder)({entryCount:X.entryCount,chunkOffsets:x}).build();var g=new n.MediaDataBoxBuilder({data:B(U)}).build(),w=new n.SampleTableBoxBuilder([T,P,y,m,I]).build(),b=new n.MediaInformationBoxBuilder([E,f,w]).build(),A=new n.MediaBoxBuilder([p,O,b]).build(),R=new n.TrackBoxBuilder([c,A]).build(),v=new n.MovieBoxBuilder([h,R]).build();return B([l.bytes,v,g])});t.extractRawAudio=(e=>{var s=t.parse(e),r=d(s),n=new i.Finder(r).findOne(a.BOX_TYPE_MP4_AUDIO_SAMPLE_ENTRY),l=o.DecoderConfigDescriptorParser.OBJECT_TYPE_INDICATION;switch(n.esBox.esDescr.decConfigDescr.objectTypeIndication){case l.AAC:return{type:"aac",data:((e,t)=>{var s=new i.Finder(t),r=s.findOne(a.BOX_TYPE_MP4_AUDIO_SAMPLE_ENTRY),n=s.findOne(a.BOX_TYPE_SAMPLE_TO_CHUNK_BOX),o=s.findOne(a.BOX_TYPE_SAMPLE_SIZE_BOX),l=s.findOne(a.BOX_TYPE_CHUNK_OFFSET_BOX);l||(l=s.findOne(a.BOX_TYPE_CHUNK_OFFSET64_BOX));var _,d,B,u,c,p,O,E,f,T=new Uint8Array(7*o.sampleSizes.length+o.sampleSizes.reduce((e,t)=>e+t)),P=0,y=new Uint8Array(7);for(y[0]=255,y[1]=249,y[2]=64|h.indexOf(r.sampleRate)<<2|r.channelCount>>2,y[6]=252,_=0,u=0,c=n.entryCount;_<c;++_)for(d=n.entries[_].firstChunk-1,p=_+1<c?n.entries[_+1].firstChunk-1:l.chunkOffsets.length;d<p;++d)for(E=l.chunkOffsets[d],B=0,O=n.entries[_].samplesPerChunk;B<O;++B,++u)f=o.sampleSizes[u]+7,y[3]=r.channelCount<<6|f>>11,y[4]=f>>3,y[5]=f<<5|31,T.set(y,P),P+=7,T.set(e.subarray(E,E+=o.sampleSizes[u]),P),P+=o.sampleSizes[u];return T})(e,r)};case l.MP3:return{type:"mp3",data:((e,t)=>B(_(e,t)))(e,r)};default:throw new TypeError("not supported object type indication.")}}),t.aacToM4a=(e=>{var t=new l.BitReader(e),s=48;t.skipBits(12);var r={id:t.readBits(1),layer:t.readBits(2),protectionAbsent:t.readBits(1),profile:t.readBits(2),sampleingFrequencyIndex:t.readBits(4),privateBit:t.readBits(1),channelConfiguration:t.readBits(3),original:t.readBits(1),home:t.readBits(1),copyrightIndentificationBit:t.readBits(1),copyrightIndentificationStart:t.readBits(1),aacFrameLength:t.readBits(13),atdsBufferFullness:t.readBits(11),noRawDataBlocksInFrames:t.readBits(2)};t.bitOffset=0;for(var i,_=[],d=0;!t.eof();)t.skipBits(30),i=t.readBits(13),t.skipBits(13),_.push(t.readBytes(i-7)),d=Math.max(d,i-7);var u=new n.FileTypeBoxBuilder({majorBrand:"M4A ",minorVersion:1,compatibleBrands:["isom","M4A ","mp42"]}).build();s+=u.length;var c=Date.now(),p=h[r.sampleingFrequencyIndex],O=1024*_.length*600/p|0,E=[65536,0,0,0,65536,0,0,0,1073741824],f=new n.MovieHeaderBoxBuilder({creationTime:c,modificationTime:c,timescale:600,duration:O,rate:1,volume:1,matrix:E,nextTrackID:2}).build();s+=f.length;var T=new n.TrackHeaderBoxBuilder({flags:1,creationTime:c,modificationTime:c,trackID:1,duration:O,layer:0,alternateGroup:0,volume:1,matrix:E,width:0,height:0}).build();s+=T.length;var P=new n.MediaHeaderBoxBuilder({creationTime:c,modificationTime:c,timescale:600,duration:O,language:"und"}).build();s+=P.length;var y=new n.HandlerBoxBuilder({handlerType:"soun",name:"mp4.js sound media handler"}).build();s+=y.length;var m=new n.SoundMediaHeaderBoxBuilder({balance:0}).build();s+=m.length;var X=new n.DataEntryUrlBoxBuilder({flags:1,location:""}).build(),I=new n.DataReferenceBoxBuilder({entryCount:1,entries:[X]}).build(),U=new n.DataInformationBoxBuilder([I]).build();s+=U.length;var x={esDescr:{esID:0,streamDependenceFlag:0,urlFlag:0,ocrStreamFlag:0,streamPriority:0,decConfigDescr:{objectTypeIndication:o.DecoderConfigDescriptorParser.OBJECT_TYPE_INDICATION.AAC,streamType:5,upStream:0,bufferSizeDB:d,maxBitrate:0,avgBitrate:0,decSpecificInfo:{data:new Uint8Array([18,16])}},slConfigDescr:{preDefined:2}}},S={type:a.BOX_TYPE_MP4_AUDIO_SAMPLE_ENTRY,dataReferenceIndex:1,channelCount:r.channelConfiguration,sampleSize:16,sampleRate:p,esBox:x},D=(new n.MP4AudioSampleEntryBuilder({type:a.BOX_TYPE_MP4_AUDIO_SAMPLE_ENTRY,dataReferenceIndex:1,channelCount:r.channelConfiguration,sampleSize:16,sampleRate:p,esBox:x}).build(),new n.SampleDescriptionBoxBuilder({entryCount:1,boxes:[S]}).build());s+=D.length;var g=new n.TimeToSampleBoxBuilder({entryCount:1,entries:[{sampleCount:_.length,sampleDelta:1024}]}).build();s+=g.length;var w=new n.SampleSizeBoxBuilder({sampleSize:0,sampleCount:_.length,sampleSizes:_.map(e=>e.byteLength)}).build();s+=w.length;var b=_.length%16,A=b?2:1,R=[{firstChunk:1,samplesPerChunk:16,sampleDescriptionIndex:1}];2===A&&R.push({firstChunk:Math.floor(_.length/16)+1,samplesPerChunk:b,sampleDescriptionIndex:1});var v=new n.SampleToChunkBoxBuilder({entryCount:A,entries:R}).build();s+=v.length;for(var C=Math.ceil(_.length/16),Y=s+=4+4*C+12,M=[],N=0,F=_.length;N<F;++N)N%16==0&&M.push(Y),Y+=_[N].byteLength;var L=new n.ChunkOffsetBoxBuilder({entryCount:C,chunkOffsets:M}).build(),k=new n.SampleTableBoxBuilder([D,g,w,v,L]).build(),H=new n.MediaInformationBoxBuilder([m,U,k]).build(),G=new n.MediaBoxBuilder([P,y,H]).build(),j=new n.TrackBoxBuilder([T,G]).build(),V=new n.MovieBoxBuilder([f,j]).build(),z=new n.MediaDataBoxBuilder({data:B(_)}).build();return B([u,V,z])})},function(e,t,s){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)Object.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const i=s(3),a=s(8),n=s(7),o=s(1),l=r(s(11)),h=r(s(0)),_=r(s(5)),d=r(s(4)),B=r(s(6)),u=r(s(2));t.Mp4=Object.assign({DataView2:o.DataView2,BitReader:i.BitReader,BitWriter:n.BitWriter,Finder:a.Finder},l,h,{Builder:Object.assign({},_,d),Parser:Object.assign({},B,u)})},,,,,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(12);window.Mp4=r.Mp4}]);